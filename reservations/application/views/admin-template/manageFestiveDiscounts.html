
<div class="animated fadeIn" ng-controller="FestiveDiscountController">
    <div class="row">
        <div class="col-lg-12">
            
            <div class="card">
                <div class="card-header">
                    <i class="fa fa-align-justify"></i> Manage Discounts - {{heading}}
                </div>
    <div class="card">
                <div class="card-header">
                    <strong>Add / Edit Discount -  {{heading}}</strong>
                </div>
                 <form  method="post" id="formRow2"  name="discountForm" class="form-horizontal " ng-submit="addEditFestiveDiscount(discountForm)" ng-validate="validationOptions" enctype="multipart/form-data">
                     <input type="hidden" name="id" ng-model="formData.id" />
                <div class="card-block">
                        <div class="form-group row">
                            <label class="col-md-3 form-control-label" for="email">Coupon Code</label>
                            <div class="col-md-9">
                                <input type="text"  name="coupon_code"  class="form-control"  placeholder="Enter Coupon Code"  ng-model="formData.coupon_code" maxlength="6">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-3 form-control-label" for="title">Coupon Title</label>
                            <div class="col-md-9">
                                <input type="text"  name="title"  class="form-control"  placeholder="Enter Coupon Title"  ng-model="formData.title">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-3 form-control-label" for="name">Coupon Type</label>
                            <div class="col-md-9">
                                <select id="coupon_type" name="coupon_type" ng-model="formData.coupon_type"  class="form-control">
                                    <option value="0">Fixed</option>
                                    <option value="1">Percent</option>
                                </select>
                                
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-3 form-control-label" for="name">Public / Private</label>
                            <div class="col-md-9">
                                <select id="is_public" name="is_public" ng-model="formData.is_public"  class="form-control">
                                    <option value="0">Private</option>
                                    <option value="1">Public</option>
                                </select>
                                
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-3 form-control-label" for="name">Transportation Type</label>
                            <div class="col-md-9">
                                <select id="transportation_type" name="transportation_type" ng-model="formData.transportation_type"  class="form-control">
                                    <option value="0">Private Transportation</option>
                                    <option value="1">Cabo Shuttle</option>
                                </select>
                                
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-3 form-control-label" for="email">Coupon Amount ($)</label>
                            <div class="col-md-9">
                                <input type="text"  name="coupon_amount"  class="form-control"  placeholder="Enter Coupon Amount"  ng-model="formData.coupon_amount">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-3 form-control-label" for="email">Discount Image</label>
                            <div class="col-md-9">
                                <img ng-if="couponImage" ng-src="{{formData.image}}" style="width:150px;height:120px;" />
                                <input type="file"  name="discount_image"  class="form-control" ng-model="formData.discount_image"  file-model="myFile" onchange="return validateFile(this,'jpg|jpeg|png')">
                            </div>
                        </div>
                       <div class="form-group row">
                            <label class="col-md-3 form-control-label" for="email">Date Range</label>
                            <div class="col-md-9">
                                <input type="text"  name="date_range"  class="form-control"  placeholder="Enter Date Range"  ng-model="formData.date_range">
                            </div>
                        </div>
                </div>
                <div class="card-footer">
                    <button type="submit" class="btn btn-sm btn-primary" name="submitButton" ng-model="submitBtn"  ng-disabled="discountForm.$invalid"><i class="fa fa-dot-circle-o"></i>{{btnName}}</button>
                     <button class="btn btn-sm btn-primary" name="submitButton2" ng-show="cancelShow" ng-click="cancelUpdate()" type="button" ><i class="fa fa-dot-circle-o"></i>Cancel</button>
                </div>
                  </form>
            </div>
                <table ng-init="init()"  st-table="discountsData" id="formRow" st-safe-src="discounts"  class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th row-select-all="discountsData"  selected="selected" ng-click="selectAll(discountsData)"></th>
                            <th>Coupon Code</th>
                            <th>Type</th>
                            <th>Public/Private</th>
                            <th>Transportation</th>
                            <th>Amount</th>
                            <th>Slider 2 Coupon</th>
                           <th>Date Range</th>
                            <th>Action</th>
                        </tr>
                        <tr>
                            <th></th>
                            <th><input class="form-control" st-search="name"/></th>
                            <th></th>
                            <th></th>
                            
                        </tr>
                    </thead>
                    <tbody ng-show="!isLoading">
                        <tr ng-if="discounts.length == 0"><td colspan="8">No record found.</td></tr>
                        <tr ng-repeat="row in discountsData track by $index" >
                            <td row-select="row" ng-click="select(row.id)"></td>
                            <td>{{row.coupon_code}}</td>
                            <td>
                                <span ng-if="row.coupon_type == 0 || row.coupon_type == null">Fixed</span>
                                <span ng-if="row.coupon_type == 1">Percent</span>
                            </td>
                            <td>
                                <span ng-if="row.is_public == 0 || row.is_public == null">Private</span>
                                <span ng-if="row.is_public == 1">Public</span>
                            </td>
                            <td>
                                <span ng-if="row.transportation_type == 0 || row.transportation_type == null">Private Transportation</span>
                                <span ng-if="row.transportation_type == 1">Cabo Shuttle</span>
                            </td>
                            <td>
                                <span ng-if="row.coupon_type == 0 || row.coupon_type == null">${{row.coupon_amount}}</span>
                                <span ng-if="row.coupon_type == 1">{{row.coupon_amount}}%</span>
                            </td>
                            <td>
                                <span ng-if="row.is_public == 0 || row.is_public == null">--</span>
                                <span ng-if="row.is_public == 1">
                                    <span ng-if="row.is_slider2_coupon == 1">
                                        <input type="radio" name="is_slider2_coupon" ng-change="logIt(row.id)" checked value="{{row.id}}">
                                    </span>
                                    <span ng-if="row.is_slider2_coupon == 0">
                                        <input type="radio" name="is_slider2_coupon" ng-change="logIt(row.id)" ng-model="is_slider2_coupon" value="{{row.id}}">
                                    </span>
                                </span>
                            </td>
                            <td>{{row.start_date}} To {{row.end_date}}</td>
                           <td><a href="javascript:void(0)" ng-click="editDiscount(row)">Edit</a></td>
                        </tr>
                    </tbody>
<!--                    <tbody ng-show="isLoading">
                        <tr>
                            <td colspan="8" class="text-center">Loading ... </td>
                        </tr>
                    </tbody>-->
                    <tfoot>
                        <tr>
                            <td class="text-center" colspan="8">
                                <div class="row">
                                    <div class="col-lg-6" align="left"><button type="button" v="{{selected}}" ng-disabled="!(selected.length > 0)" ng-click="deleteDiscount()">Delete</button></div>                                
                                    <div class="col-lg-6" align="right" st-pagination="" st-items-by-page="itemsPerPage"  st-displayed-pages="4"></div>
                                </div>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
        <!--/.col-->

        <!--/.col-->
    </div>
    <!--/.row-->

    <!--/.row-->
</div>
<script type="text/javascript">
    function validateFile(input,ext,size)
    {
        var file_name = input.value;
        var split_extension = file_name.split(".").pop();
        var extArr = ext.split("|");
        if($.inArray(split_extension.toLowerCase(), extArr ) == -1)
        {
          $(input).val("");
          alert('You Can Upload Only .'+extArr.join(", ")+' files !');
          return false;
        }
        if(size != ""){
          
        }
    }
    $('input[name="date_range"]').daterangepicker({
        locale: {
          format: 'YYYY-MM-DD'
        }
    });
</script>